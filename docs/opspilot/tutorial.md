---
sidebar_position: 4
---

# 实践指南

本文档是 Web 应用 / Postgres DB / Kubernetes 集群 三类自动化巡检助手的实操配置指南，通过清晰的步骤说明、截图指引和关键注意事项，帮助用户快速完成从前期准备、智能体配置到链路发布、结果验证的全流程实践。

核心内容覆盖

- Web 应用巡检助手：Web 服务健康巡检（定时 / 按需触发）、异常告警与 HTML 报告自动生成；
- Postgres DB 助手：PostgreSQL 数据库 8 类核心指标巡检、风险项识别与标准化报告推送；
- Kubernetes 集群巡检助手：K8s 集群节点 / Pod / 工作负载异常检测、状态汇总与可视化报告输出。


## Web应用巡检助手配置指南

### 一、功能概述
「Web 应用巡检助手」可对指定的 Web 服务进行定时或按需健康巡检，自动采集访问结果并进行汇总分析，异常时通过配置渠道及时告警，帮助运维人员零代码快速搭建自动化巡检告警流程。

该能力适用于常规可用性监控、上线前巡检验证以及异常后的持续观测场景。

#### 核心能力
Web 应用巡检助手通过「**触发 → 自动巡检 → 结果汇总 → 异常通知**」形成完整的巡检闭环：
- 🕒 **多触发方式**：支持定时触发、RESTful API调用等多种触发模式 
- 🤖 **智能体协作**：通过「Web应用巡检助手」和「Web应用数据汇总」两个智能体完成数据采集与聚合 
- 📢 **灵活通知**：支持邮件、钉钉、企业微信等多种通知渠道，异常发生时及时告警。 
- 📊 **标准化报告**：自动生成HTML格式可视化巡检报告，包含评分、异常详情，便于快速定位问题

### 二、适用场景与人群
#### 2.1 适用场景
- 对线上 Web 服务进行周期性健康检查
- 在业务高峰前后自动执行可用性巡检
- 发现异常时第一时间通知相关人员

#### 2.2 适用人群
- 运维人员：快速搭建Web服务监控告警流程
- 开发人员：为自研Web应用配置基础健康检查
- 业务人员：查看巡检报告与告警结果


### 三、使用前准备（重要）

在开始配置 Web 应用巡检助手前，请确保已完成以下准备工作：

#### 3.1  **已配置 LLM 模型**
1. 登录BlueKing Lite平台 → OpsPilot导航栏 → 模型 → LLM Model → 添加并启用可用的LLM模型
![功能图片1.png](https://static.cwoa.net/d8b0c316e54f455e8446771de70fcef3.png)
  - **模型名称**：模型的官方技术名称（如 `gpt-oss:120b`），需与接口侧定义一致。
  - **网址**：模型接口的 API 地址（如 `https://new-api.pawlab.dev/v1`）。
  - **API密钥**：访问该模型接口的授权密钥，需妥善保管。

#### 3.2. **已配置通知方式**
1. 登录BlueKing Lite平台 → Setting导航栏 → 组织 → 搜索用户名 → 配置接收报告的邮箱（钉钉/企微可配置机器人Webhook）
![功能图片2.png](https://static.cwoa.net/0b94ae130b1d4f23b53c9f588e5b8ace.png)

#### 3.3 **已配置智能体节点**
需先在「智能体」模块完成两个核心智能体的配置，再回到工作台关联使用：
![功能图片3.png](https://static.cwoa.net/1790afbb45514b1f9d68d5dd224b2cab.png)

智能体1：Web应用巡检助手
- **核心功能**：执行Web应用自动化巡检任务，按固定顺序检查目标页面所有菜单并记录状态，输出包含各菜单检查结果的基础巡检报告。
- **配置步骤**：·
  1. 在「智能体」列表中选择「Web应用巡检助手」，进入配置页面；
  2. 在配置面板中选择并配置适配的**LLM模型**；
  3. 在提示词配置区域，补充巡检登录信息（用户名、密码）；
  ![功能图片4.png](https://static.cwoa.net/b89a759ae44f4583862487b9ae51a29e.png)
  4. 配置工具【Browser_USE】确认配置无误后，点击「保存」。
  ![功能图片4.png](https://static.cwoa.net/d1c4472633764ebda74a0a0668d3de7f.png)

智能体2：Web应用数据汇总
- **核心功能**：将巡检原始结果加工为标准化HTML邮件表格报告，按规则对巡检项评分、计算总分与总评，生成可直接嵌入邮件的可视化报告。
- **配置步骤**：
  1. 在「智能体」列表中选择「Web应用数据汇总」，进入配置页面；
  2. 在配置面板中选择并配置适配的**LLM模型**；
  ![功能图片5.png](https://static.cwoa.net/e2d81e0f74f6418fb373745ba858b3ba.png)
  3. 确认配置无误后，点击「保存」。

### 四、操作步骤
✅ 关键提示：进入本环节前，请确保已完成「使用前准备」的所有配置，否则将无法顺利完成链路配置。
#### 4.1 进入配置页面
1.  OpsPilot导航栏 → 工作台 → 点击「Web应用巡检助手」卡片，进入配置画布。
![功能图片6.png](https://static.cwoa.net/36104105011d4cd4b7bd04c18c2e3147.png)
![功能图片7.png](https://static.cwoa.net/2c0f3349934a4f41bdcc7e1f8a5b08c5.png)

> 说明：画布已默认生成「定时触发 → Web应用巡检助手 → Web应用数据汇总 → 对外通知」的完整链路，只需依次配置每个节点的参数：

#### 4.2 设置触发方式
1.  点击画布中的「定时触发」节点，打开配置弹窗：
![功能图片8.png](https://static.cwoa.net/7e2d5438cd9844e1a3da0b6aac6f4efa.png)
2. （可选）其他触发方式，如RESTful API 触发：切换触发模式为「RESTful API」，配置 API 调用地址

⚠️ 注意：触发规则需在**链路发布后**才会生效。

#### 4.3 配置智能体节点
画布中的「Web 应用巡检助手」与「Web 应用数据汇总」节点已默认关联，请确保已配置好智能体的参数。  
若无特殊需求，保持默认即可；如需调整，可点击节点选择其他已配置的智能体。

#### 4.4 配置对外通知
1.  点击「对外通知」节点，确保已在setting配置好接受的邮箱，配置核心信息：
  ![功能图片9.png](https://static.cwoa.net/aae379904d404bd28c5df9fa9d2c6a65.png)
    - 通知渠道：选择邮件、企业微信机器人等目标渠道；
    - 通知人：添加需接收巡检报告的人员/群组；
    - 通知标题：自定义标题（如“WeOps平台Web应用巡检报告”）；
2.  点击「确认」。

#### 4.5 上线发布与验证
1.  确认所有节点配置完成 → 点击「设置」→ 保存&发布；
2. 触发任务：  
   - 自动触发：等待定时周期到达  
   - 手动触发：点击触发节点的 **执行节点** 按钮，输入【巡检，并生成报告】 
   ![功能图片10.png](https://static.cwoa.net/64e697f42dd74019804ccf085616cd89.png)
3. 验证结果：  
   - 确认通知渠道收到巡检报告  
    ![功能图片11.png](https://static.cwoa.net/ca75b2fa70934d918fedbf138e1abc41.png)
   - 日志页面查看执行记录  
    ![功能图片12.png](https://static.cwoa.net/93ea124b57ce490d97b7d20016762ae8.png)


## Postgres DB助手快速上手指南
### 一、功能概述
Postgres DB助手是数据库自动化巡检工具。通过双智能体协作模式，实现 PostgreSQL 数据库从 指标巡检 → 结果分析 → 报告生成 → 告警通知 的全流程自动化，无需编写 SQL 或脚本，即可完成日常数据库健康检查。

该助手聚焦 异常与风险项输出，自动生成标准化 HTML 巡检报告，显著降低人工巡检成本，提升数据库运维效率与可视化水平。

#### 核心能力
- **智能巡检**：自动采集实例状态、连接数、性能、空间、锁阻塞等 **8类核心指标**，仅输出异常或高风险信息；
- **报告生成**：将巡检结果整理为包含评分与分析结论的 **HTML 巡检报告**，可直接通过邮件查看；
- **灵活触发**：支持定时触发、手动执行、API 调用等方式，异常结果可通过邮件等渠道自动通知。

### 二、适用场景与人群
#### 2.1 适用场景
- 对 PostgreSQL 实例进行**快速、自动化巡检**，聚焦异常与风险项  
- 定时或按需生成 **数据库健康巡检报告**，用于邮件、群通知等场景  
- 希望将结构化巡检结果自动整理为 **标准化 HTML 报告** 的运维流程 

#### 2.2 适用人群
- 数据库运维人员：对 PostgreSQL 实例执行快速巡检，及时发现异常与风险项  
- SRE / 平台运维：定时生成标准化数据库巡检报告，用于邮件或群通知  
- 技术支持人员：在问题排查前快速获取实例健康状态概览  
- 企业技术团队：通过智能体自动化完成 PostgreSQL 健康检查与结果汇总

### 三、使用前准备（重要）

在开始配置 Web 应用巡检助手前，请确保已完成以下准备工作：

#### 3.1  **已配置 LLM 模型**
1. 登录BlueKing Lite平台 → OpsPilot导航栏 → 模型 → LLM Model → 添加并启用可用的LLM模型
![功能图片1.png](https://static.cwoa.net/d8b0c316e54f455e8446771de70fcef3.png)
  - **模型名称**：模型的官方技术名称（如 `gpt-oss:120b`），需与接口侧定义一致。
  - **网址**：模型接口的 API 地址。
  - **API密钥**：访问该模型接口的授权密钥，需妥善保管。

#### 3.2 **已配置通知方式**
1. 登录BlueKing Lite平台 → Setting导航栏 → 组织 → 搜索用户名 → 配置接收报告的邮箱（钉钉/企微可配置机器人Webhook）
![功能图片2.png](https://static.cwoa.net/0b94ae130b1d4f23b53c9f588e5b8ace.png)

#### 3.3 配置智能体节点
1. 登录BlueKing Lite平台 → OpsPilot导航栏 → 智能体
![功能图片3.png](https://static.cwoa.net/9cd7e6c5ce994b3590ec10ccf0c5d00b.png)

智能体1：Postgres DB 助手
- **核心功能**：从 PostgreSQL 数据库中提取、筛选、整理关键巡检数据，最终输出符合指定格式的简洁文本结果。
- **配置步骤**：
  1. 在「智能体」列表中选择「Postgres DB 助手」，进入配置页面；
  2. 在配置面板中选择并配置适配的**LLM模型**；
   ![功能图片4.png](https://static.cwoa.net/8066c2ac1c654d65bad5e4a4bef143b2.png)
  3. 在工具【postgres】配置，PostgreSQL数据库连接信息（地址、端口、数据库名、用户名、密码），确保平台可访问目标数据：
   ![功能图片5.png](https://static.cwoa.net/3b338b130f934a9d8a638b15aff9c077.png)
  4. 确认配置无误后，点击「保存」。

智能体2：Postgres DB 数据汇总
- **核心功能**：负责将第一个智能体产出的文本巡检结果，转换成可直接嵌入邮件正文的完整 HTML 代码，包括巡检数据表格、评分及关键信息。
- **配置步骤**：
  1. 在「智能体」列表中选择「Postgres DB 数据汇总」，进入配置页面；
  2. 在配置面板中选择并配置适配的**LLM模型**；
    ![功能图片6.png](https://static.cwoa.net/74cdde68208a4fb5a2d6e6ba8eaeb3ee.png)
  3. 确认配置无误后，点击「保存」。

### 四、操作步骤
✅ 关键提示：进入本环节前，请确保已完成「使用前准备」的所有配置，否则将无法顺利完成链路配置。
#### 4.1 进入配置页面
1.  OpsPilot导航栏 → 工作台 → 点击「Postgres DB 助手」卡片，进入配置画布。
![功能图片7.png](https://static.cwoa.net/ae138be89b0b45c9b4d9e2ef35d1952a.png)
![功能图片8.png](https://static.cwoa.net/39ce6a76709840f3b9cf7cc4aafefff6.png)

> 说明：画布已默认生成「定时触发 → Postgres DB 助手 → Postgres DB 数据汇总 → 对外通知」的完整链路，只需依次配置每个节点的参数：


#### 4.2 设置触发方式
1.  点击画布中的「定时触发」节点，打开配置弹窗：
![功能图片9.png](https://static.cwoa.net/901c45ad4dbd4defa5ed09d2ac21c0f1.png)
2. （可选）其他触发方式，如RESTful API 触发：切换触发模式为「RESTful API」，配置 API 调用地址

⚠️ 注意：触发规则需在**链路发布后**才会生效。

#### 4.3 配置智能体节点
画布中的「Postgres DB 数据汇总」与「Postgres DB 助手」节点已默认关联，请确保已配置好智能体的参数。  
若无特殊需求，保持默认即可；如需调整，可点击节点选择其他已配置的智能体。

#### 4.4 配置对外通知
1.  点击「对外通知」节点，确保已在setting配置好接受的邮箱，配置核心信息：
  ![功能图片10.png](https://static.cwoa.net/c9c8fbaf6117433fb60248fbd721d4e0.png)
    - 通知渠道：选择邮件、企业微信机器人等目标渠道；
    - 通知人：添加需接收巡检报告的人员/群组；
    - 通知标题：自定义标题（如“PostgreSQL巡检数据库健康报告”）；
3.  点击「确认」。

#### 4.5 上线发布与验证
1.  确认所有节点配置完成 → 点击「设置」→ 保存&发布；
2. 触发任务：  
   - 自动触发：等待定时周期到达  
   - 手动触发：点击触发节点的 **执行节点** 按钮，输入【巡检，并生成报告】 
   ![功能图片11.png](https://static.cwoa.net/64e697f42dd74019804ccf085616cd89.png)
3. 验证结果：  
   - 确认通知渠道收到巡检报告  
    ![功能图片12.png](https://static.cwoa.net/5c348a837da349e88a3954cc8bf84331.png)
   - 日志页面查看执行记录  
    ![功能图片13.png](https://static.cwoa.net/39901b5af83e4a84a4bf9e19dbd4a228.png)


## Kubernetes 集群巡检助手配置指南

### 一、功能概述
「Kubernetes 集群巡检助手」用于对 Kubernetes 集群进行快速健康巡检，自动识别集群中存在的异常节点、异常 Pod、不健康工作负载及存储问题，并将巡检结果汇总为标准化 HTML 报告，通过通知渠道发送给相关人员。

该能力以“只关注异常”为核心原则，避免无效信息干扰，适合用于日常巡检、发布前检查及异常后的状态确认。

#### 核心能力
Kubernetes 巡检助手通过「**触发 → 自动巡检 → 结果汇总 → 异常通知**」形成完整的巡检闭环：
- 🕒 **多触发方式**：支持定时触发、RESTful API调用等多种触发模式 
- 🤖 **智能体协作**：通过「Kubernetes 助手」和「Kubernetes 数据汇总」两个智能体完成数据采集与聚合 
- 📢 **灵活通知**：支持邮件、钉钉、企业微信等多种通知渠道，异常发生时及时告警。 
- 📊 **标准化报告**：自动生成HTML格式可视化巡检报告，包含评分、异常详情，便于快速定位问题


### 二、适用场景与人群
#### 2.1 适用场景
- 对 Kubernetes 集群进行定期健康巡检
- 快速定位集群中的异常节点、Pod 或工作负载
- 异常发生后，统一汇总当前集群状态并对外通知

#### 2.2 适用人群
- 运维人员：快速掌握集群整体健康状态
- 开发人员：用于稳定性巡检与运行态可视化
- 业务人员：查看巡检报告与告警结果


### 三、使用前准备（重要）

在开始配置 Web 应用巡检助手前，请确保已完成以下准备工作：

#### 3.1  **已配置 LLM 模型**
1. 登录BlueKing Lite平台 → OpsPilot导航栏 → 模型 → LLM Model → 添加并启用可用的LLM模型
![功能图片1.png](https://static.cwoa.net/d8b0c316e54f455e8446771de70fcef3.png)
  - **模型名称**：模型的官方技术名称（如 `gpt-oss:120b`），需与接口侧定义一致。
  - **网址**：模型接口的 API 地址（如 `https://new-api.pawlab.dev/v1`）。
  - **API密钥**：访问该模型接口的授权密钥，需妥善保管。

#### 3.2. **已配置通知方式**
1. 登录BlueKing Lite平台 → Setting导航栏 → 组织 → 搜索用户名 → 配置接收报告的邮箱（钉钉/企微可配置机器人Webhook）
![功能图片2.png](https://static.cwoa.net/0b94ae130b1d4f23b53c9f588e5b8ace.png)

#### 3.3 **已配置智能体节点**
1. 登录BlueKing Lite平台 → OpsPilot导航栏 → 智能体
![功能图片3.png](https://static.cwoa.net/80a56f9f88144e228e4647cda1cf00a1.png)

智能体1：Kubernetes 助手
- **核心功能**：快速巡检 K8s 集群的集群概览、节点 / Pod / 工作负载 / 存储异常及最近 Warning 事件 6 大项，仅统计正常资源数量、提取异常资源关键字段，输出结构化文本巡检结果。
- **配置步骤**：·
  1. 在「智能体」列表中选择「Kubernetes 助手」，进入配置页面；
  2. 在配置面板中选择并配置适配的**LLM模型**；
    ![功能图片4.png](https://static.cwoa.net/533587a378b14c1ba37220591e1dae99.png)
  3.  在工具【kubernetes】配置kubeconfig_data；
    ![功能图片4.png](https://static.cwoa.net/00e3b8c838d8467ba1fc5a2e18b9febd.png)
  4. 确认配置无误后，点击「保存」。

智能体2：Kubernetes 数据汇总
- **核心功能**：将巡检原始结果加工为标准化HTML邮件表格报告，按规则对巡检项评分、计算总分与总评，生成可直接嵌入邮件的可视化报告。
- **配置步骤**：
  1. 在「智能体」列表中选择「Kubernetes 数据汇总」，进入配置页面；
  2. 在配置面板中选择并配置适配的**LLM模型**；
  ![功能图片5.png](https://static.cwoa.net/d2593f7b877c4b38a9612341dfb17c03.png)
  3. 确认配置无误后，点击「保存」。

### 四、操作步骤
✅ 关键提示：进入本环节前，请确保已完成「使用前准备」的所有配置，否则将无法顺利完成链路配置。
#### 4.1 进入配置页面
1.  OpsPilot导航栏 → 工作台 → 点击「Kubernetes 助手」卡片，进入配置画布。
![功能图片6.png](https://static.cwoa.net/445c781e2d3a4ae69fa255f963218ee2.png)
![功能图片7.png](https://static.cwoa.net/46c4c920fbe8418988b61706d0068a19.png)

> 说明：画布已默认生成「定时触发 → Web应用巡检助手 → Web应用数据汇总 → 对外通知」的完整链路，只需依次配置每个节点的参数：

#### 4.2 设置触发方式
1.  点击画布中的「定时触发」节点，打开配置弹窗：
![功能图片8.png](https://static.cwoa.net/7e2d5438cd9844e1a3da0b6aac6f4efa.png)
2. （可选）其他触发方式，如RESTful API 触发：切换触发模式为「RESTful API」，配置 API 调用地址

⚠️ 注意：触发规则需在**链路发布后**才会生效。

#### 4.3 配置智能体节点
画布中的「Kubernetes 助手」与「Kubernetes 数据汇总」节点已默认关联，请确保已配置好智能体的参数。  
若无特殊需求，保持默认即可；如需调整，可点击节点选择其他已配置的智能体。

#### 4.4 配置对外通知
1.  点击「对外通知」节点，确保已在setting配置好接受的邮箱，配置核心信息：
  ![功能图片9.png](https://static.cwoa.net/aae379904d404bd28c5df9fa9d2c6a65.png)
    - 通知渠道：选择邮件、企业微信机器人等目标渠道；
    - 通知人：添加需接收巡检报告的人员/群组；
    - 通知标题：自定义标题
2.  点击「确认」。

#### 4.5 上线发布与验证
1.  确认所有节点配置完成 → 点击「设置」→ 保存&发布；
2. 触发任务：  
   - 自动触发：等待定时周期到达  
   - 手动触发：点击触发节点的 **执行节点** 按钮，输入【巡检，并生成报告】 
   ![功能图片10.png](https://static.cwoa.net/64e697f42dd74019804ccf085616cd89.png)
3. 验证结果：  
   - 确认通知渠道收到巡检报告  
   ![功能图片11.png](https://static.cwoa.net/9813431405454ffeb36c4de8e9c15dae.png)
   - 日志页面查看执行记录  
   ![功能图片12.png](https://static.cwoa.net/53c516d223304c889d7903241efc3d27.png)
